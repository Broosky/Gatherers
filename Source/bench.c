/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Program Name: Gatherers (C)                                                                                             //
// Author: Jeffrey Bednar                                                                                                  //
// Copyright (c) Illusion Interactive, 2011 - 2025.                                                                        //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#ifndef _BENCH_C_
#define _BENCH_C_
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#ifdef _WIN32
#include "../Headers/main.h"
#include <windows.h>
#else
#include <time.h>
#endif
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double __cdecl BENCH_Run(void* (*vpBenchFunction)(void*), void* data) {
#ifdef _WIN32
	LARGE_INTEGER Frequency, Start, End;
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	QueryPerformanceFrequency(&Frequency);
	QueryPerformanceCounter(&Start);
	vpBenchFunction(data);
	QueryPerformanceCounter(&End);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// Seconds
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	return (double)(End.QuadPart - Start.QuadPart) / (double)Frequency.QuadPart;
#else
	struct timespec Start, End;
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	clock_gettime(CLOCK_MONOTONIC, &Start);
	vpBenchFunction(data);
	clock_gettime(CLOCK_MONOTONIC, &End);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// Nanoseconds
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	return (End.tv_sec - Start.tv_sec) + (End.tv_nsec - Start.tv_nsec) / 1000000000.0;
#endif
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#endif
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
