/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Program Name: Gatherers (C)                                                                                             //
// Author: Jeffrey Bednar                                                                                                  //
// Copyright (c) Illusion Interactive, 2011 - 2025.                                                                        //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include "../Headers/common.h"
#include "../Headers/common_types.h"
#include "../Headers/constants.h"
#include "../Headers/globals.h"
#include "../Headers/windows_macros.h"
#include <stdio.h>
#include <stdlib.h>
#include <windows.h>
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int __cdecl MISC_RandomNumber(int iMinimum, int iMax) {
    return rand() % (iMax - iMinimum + 1) + iMinimum;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
float __cdecl MISC_CalculateRadians(float fDegree) {
    return fDegree * PI / 180.0f;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void __cdecl MISC_ResizeWindow(HWND hWnd, UINT uiClientWidth, UINT uiClientHeight) {
    RECT WindowArea;
    RECT ClientArea;
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    GetWindowRect(hWnd, &WindowArea);
    GetClientRect(hWnd, &ClientArea);
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    UINT uiLRBBorderWidth = (WindowArea.right - WindowArea.left - ClientArea.right) >> 1;
    UINT uiTopBorderWidth = WindowArea.bottom - WindowArea.top - ClientArea.bottom - uiLRBBorderWidth;
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Resize the window to the proper size.
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    MoveWindow(hWnd, 0, 0, uiClientWidth + (uiLRBBorderWidth << 1), uiClientHeight + uiTopBorderWidth + uiLRBBorderWidth, 1);
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    GetWindowRect(hWnd, &WindowArea);
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Position the window to the center of the screen.
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    IDELTA_T WindowSize = { WindowArea.right - WindowArea.left, WindowArea.bottom - WindowArea.top };
    IDELTA_T HalfWindowSize = { WindowSize.iDx >> 1, WindowSize.iDy >> 1 };
    IPOINT_T MidScreen = { GetSystemMetrics(SM_CXSCREEN) >> 1, GetSystemMetrics(SM_CYSCREEN) >> 1 };
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    MoveWindow(hWnd, MidScreen.iX - HalfWindowSize.iDx, MidScreen.iY - HalfWindowSize.iDy, WindowSize.iDx, WindowSize.iDy, 1);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void __cdecl MISC_FormatTime(ULONG ulSecondsTick, char* p_szBuffer, size_t p_szBufferSize) {
    ULONG ulSeconds = ulSecondsTick % 60;
    ULONG ulMinutes = (ulSecondsTick / 60) % 60;
    ULONG ulHours = (ulSecondsTick / 3600) % 24;
    ULONG ulDays = ulSecondsTick / 86400;
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    snprintf(p_szBuffer, p_szBufferSize, "%02lud %02luh %02lum %02lus", ulDays, ulHours, ulMinutes, ulSeconds);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void __cdecl MISC_FormatWithCommas(char* p_szFormatted, size_t stFormattedSize, unsigned long long ullNumber) {
    char szTemp[32];
    snprintf(szTemp, sizeof(szTemp), "%llu", ullNumber);
    int szLength = strlen(szTemp);
    int iFormattedIndex = 0;
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	int i;
    for (i = 0; i < szLength && iFormattedIndex < (int)stFormattedSize - 1; ++i) {
        p_szFormatted[iFormattedIndex++] = szTemp[i];
        if ((szLength - i - 1) % 3 == 0 && i != szLength - 1 && iFormattedIndex < (int)stFormattedSize - 1) {
            p_szFormatted[iFormattedIndex++] = ',';
        }
    }
    p_szFormatted[iFormattedIndex] = '\0';
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
