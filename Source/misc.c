/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Program Name: Gatherers (C)                                                                                             //
// Author: Jeffrey Bednar                                                                                                  //
// Copyright (c) Illusion Interactive, 2011 - 2025.                                                                        //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#ifndef _MISC_C_
#define _MISC_C_
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include "../Headers/constants.h"
#include "../Headers/types.h"
#include <wtypes.h>
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int __cdecl MISC_RandomNumber(int iMinimum, int iMax) {
    return rand() % (iMax - iMinimum + 1) + iMinimum;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
float __cdecl MISC_CalculateRadians(float fDegree) {
    return fDegree * PI / 180.0f;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void __cdecl MISC_ResizeWindow(HWND hWnd, UINT uiClientWidth, UINT uiClientHeight) {
    RECT WindowArea;
    RECT ClientArea;
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    GetWindowRect(hWnd, &WindowArea);
    GetClientRect(hWnd, &ClientArea);
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    UINT uiLRBBorderWidth = (WindowArea.right - WindowArea.left - ClientArea.right) >> 1;
    UINT uiTopBorderWidth = WindowArea.bottom - WindowArea.top - ClientArea.bottom - uiLRBBorderWidth;
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Resize the window to the proper size.
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    MoveWindow(hWnd, 0, 0, uiClientWidth + (uiLRBBorderWidth << 1), uiClientHeight + uiTopBorderWidth + uiLRBBorderWidth, 1);
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    GetWindowRect(hWnd, &WindowArea);
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Position the window to the center of the screen.
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    IPOINT WindowSize = { WindowArea.right - WindowArea.left, WindowArea.bottom - WindowArea.top };
    IPOINT HalfWindowSize = { WindowSize.iX >> 1, WindowSize.iY >> 1 };
    IPOINT MidScreen = { GetSystemMetrics(SM_CXSCREEN) >> 1, GetSystemMetrics(SM_CYSCREEN) >> 1 };
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    MoveWindow(hWnd, MidScreen.iX - HalfWindowSize.iX, MidScreen.iY - HalfWindowSize.iY, WindowSize.iX, WindowSize.iY, 1);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void __cdecl MISC_FormatTime(ULONG ulSecondsTick, char* p_szBuffer, size_t p_szBufferSize) {
    ULONG ulSeconds = ulSecondsTick % 60;
    ULONG ulMinutes = (ulSecondsTick / 60) % 60;
    ULONG ulHours = (ulSecondsTick / 3600) % 24;
    ULONG ulDays = ulSecondsTick / 86400;
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    snprintf(p_szBuffer, p_szBufferSize, "%02lud %02luh %02lum %02lus", ulDays, ulHours, ulMinutes, ulSeconds);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#endif
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
